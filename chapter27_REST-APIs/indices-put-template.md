#Put index template API

创建或更新索引模板。索引模板定义可以自动应用于新索引的设置、映射和别名。


```json
PUT /_index_template/template_1
{
  "index_patterns" : ["te*"],
  "priority" : 1,
  "template": {
    "settings" : {
      "number_of_shards" : 2
    }
  }
}
```

##请求

`PUT /_index_template/<index-template>`



##先决条件

如果已启用Elasticsearch安全功能，则必须具有`manage_index_templates`或`manage`[群集权限]()才能使用此API。

##说明

Elasticsearch基于与索引名称匹配的通配符模式将模板应用于新索引。



索引模板在数据流或索引创建期间应用。对于数据流，在创建流的备份索引时应用这些设置和映射。



[创建索引]()请求中指定的设置和映射将覆盖索引模板中指定的任何设置或映射。



对索引模板的更改不会影响现有索引，包括数据流的现有备份索引。



##索引模板中的注释

可以在索引模板中使用C语言风格的/**/块注释。除了开头的花括号之前，您可以在请求正文中的任何位置插入注释。


##路径参数

###`<index-template>`

（必需，字符串）要创建的索引模板的名称。

##请求参数

###`create`

（可选，布尔值）如果为`true`，则此请求无法替换或更新现有索引模板。默认为`false`。

###`master_timeout`

（可选，[时间单位]()）等待连接到主节点的时间。如果在超时过期之前没有收到响应，则请求失败并返回错误。默认为`30秒`。

##请求正文

###`index_patterns`

（必需，字符串数组）用于在创建期间匹配数据流和索引名称的通配符（`*`）表达式数组。


> Elasticsearch具有内置索引模板，每个模板的优先级为100，用于以下索引模式：
> 
> 
> 
* logs-*-*
* metrics-*-*
* synthetics-*-*
> 
> [Elastic代理]()使用这些模板来创建数据流。Fleet集成创建的索引模板使用类似的重叠索引模式，优先级高达`200`。
> 
> 
> 
> 如果您使用Fleet或Elastic代理，请为索引模板指定低于100的优先级，以避免覆盖这些模板。否则，为避免意外应用模板，请执行以下一个或多个操作：
> 
> 
> 
* 要禁用所有内置索引和组件模板，请设置[`stack.templates.enabled`]()已启用使用[群集更新设置API]()设置为false。
* 使用不重叠的索引模式。
* 为重叠模式的模板分配高于200的优先级。例如，如果您不使用Fleet或Elastic代理，并且希望为logs-*索引模式创建一个模板，请将模板的优先级指定为500。这将确保应用您的模板，而不是日志的内置模板`logs-*-*`。

###`composed_of`

（可选，字符串数组）组件模板名称的有序列表。组件模板按指定的顺序合并，这意味着最后指定的组件模板具有最高的优先级。有关示例，请参见组合多个组件模板。

###`priority`

（可选，整数）创建新数据流或索引时确定索引模板优先级的优先级。选择具有最高优先级的索引模板。如果未指定优先级，则将模板视为优先级为0（最低优先级）。Elasticsearch不会自动生成此号码。

###`version`

（可选，整数）用于外部管理索引模板的版本号。Elasticsearch不会自动生成此号码。

###`_meta`

（可选，对象）关于索引模板的可选用户元数据。可能有任何内容。Elasticsearch不会自动生成此地图。



