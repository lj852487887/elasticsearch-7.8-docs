#29.1 General recommendations通用建议

###不返回大结果集

Elasticsearch被设计成一个搜索引擎，这使得它能够很好地获取匹配查询的头部文档。但是，对于属于数据库域的工作负载（例如检索与特定查询匹配的所有文档）来说，这并不是一个好方法。如果需要这样做，请确保使用[Scroll]() API。

###避免使用大型文档

鉴于默认[`http.max_content_length`]()如果设置为100MB，Elasticsearch将拒绝索引任何大于该值的文档。您可能会决定增加该特定设置，但Lucene仍有大约2GB的限制。

即使不考虑硬限制，大型文档通常也不实用。大型文档在网络、内存使用和磁盘方面的压力更大，即使对于不请求`_source`的搜索请求也是如此，因为Elasticsearch在所有情况下都需要获取文档的`_id`，而对于大型文档，由于文件系统缓存的工作方式，获取此字段的成本更高。索引此类文档可以使用相当于文档原始大小数倍的内存量。邻近搜索（例如短语查询）和[高亮显示]()也变得更加昂贵，因为它们的成本直接取决于原始文档的大小。

有时，重新考虑信息单位应该是什么是有用的。例如，您希望使书籍可搜索的事实并不一定意味着文档应该由整本书组成。最好使用章节甚至段落作为文档，然后在这些文档中有一个属性来标识它们属于哪本书。这不仅避免了大型文档的问题，还使搜索体验更好。例如，如果用户搜索两个单词`foo`和`bar`，那么跨不同章节的匹配可能非常差，而同一段落中的匹配可能很好。


	